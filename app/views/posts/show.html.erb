<div id="recent-posts">
  <ul>
    <% posts.each do |p| %>
      <li>
        <% unless p.published? %>
          [ <span class="unpublished">not published</span> ]
        <% end %>
        <% if user_signed_in? %>
          <div class="actions">
            <% if p.owned_by?(current_user) || current_user.has_role?(:delete_posts) %>
              [ <%= link_to(t('delete'), post_path(p), :method => :delete, :confirm => t('posts.delete.confirm')) %> ]
            <% end %>
          </div>
        <% end %>
        <% if p == post %>
          <%= post.published_at.strftime("%B %d, %Y %H:%M %p") %>
          <div id="post">
            <div class="title">
              <%= post.title %>
            </div>
            <div class="body">
              <%= post.html.html_safe %>
            </div>
          </div>
        <% else %>
          <%= link_to(p.published_at.strftime("%B %d, %Y %H:%M %p"), post_path(p)) %>
        <% end %>
      </li>
    <% end %>
  </ul>
</div>